http://www.andybev.com/index.php/Using_iptables_and_PHP_to_create_a_captive_portal
http://aryo.info/labs/captive-portal-using-php-and-iptables.html
