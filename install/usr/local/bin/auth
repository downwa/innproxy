#!/usr/bin/perl

use strict;
use warnings;

use EBox;
use EBox::Users::User;
use Text::Password::Pronounceable;

# my $datestamp = POSIX::strftime("%s", localtime);

EBox::init();

my $parent = EBox::Users::User->defaultContainer();

    my $name = "" . $ARGV[0];
    my $pass = "" . $ARGV[1];
#    printf "AUTH uid=$name,pass=$pass\n";
	eval {
		my $dn="uid=$name,ou=Users,dc=choggiung,dc=local";
		my $user = new EBox::Users::User(dn => $dn);
		my ($password, $timestamp, $seconds) = split(' ', $user->description);
		if($password eq $pass) { printf("1\n"); }
		else { printf("Invalid username/password.\n"); }
#		printf("AUTH: %s %s\n",$user->name,$user->description);
	};
	if ($@) { printf("Invalid username/password\n"); }

1;
